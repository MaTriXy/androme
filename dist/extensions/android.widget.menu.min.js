this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";var e=androme.lib.enumeration,t=android.lib.constant,i=android.lib.base.Resource;const n={MENU:"menu",ITEM:"item",GROUP:"group"},o={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^[0-9]+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},a={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},r=["showAsAction","actionViewClass","actionProviderClass"];function d(e,t,i){for(const n in t.dataset){const o=t.dataset[n];if(o&&e[n]){const t=o.match(e[n]);if(t){i[null!=this.options.appCompat&&!0!==this.options.appCompat||!r.includes(n)?"android":"app"][n]=Array.from(new Set(t)).join("|")}}}}function s(e,t){return e.children.length>0&&e.children.some(e=>e.element.type===t)}const c=new class extends androme.lib.base.extensions.Nav{condition(){return this.included()}processNode(){const t=this.node,i=this.application.viewController.renderNodeStatic(n.MENU,0,{},"","",t,!0);return t.documentRoot=!0,t.nodeType=e.NODE_STANDARD.BLOCK,t.excludeResource|=e.NODE_RESOURCE.ALL,t.excludeProcedure|=e.NODE_PROCEDURE.ALL,t.rendered=!0,t.cascade().forEach(e=>this.subscribersChild.add(e)),{output:i,complete:!0}}processChild(){const r=this.node,c=this.parent;if(r.plainText)return r.hide(),{output:"",complete:!0,next:!0};const l=r.element,h={android:{},app:{}};let u=n.ITEM,m="",p=!1,N=!1;if(r.children.some(e=>(!e.inlineElement||!e.blockStatic)&&e.children.length>0)){if(r.children.some(e=>"NAV"===e.tagName))""!==l.title?m=l.title:Array.from(r.element.childNodes).some(e=>"#text"===e.nodeName?!(!e.textContent||""===(m=e.textContent.trim())):"NAV"!==e.tagName&&(m=e.innerText.trim(),!0)),r.each(e=>"NAV"!==e.tagName&&e.hide());else if("NAV"===r.tagName)u=n.MENU,p=!0;else{u=n.GROUP;let e="";r.children.every(e=>s(e,"radio"))?e="single":r.children.every(e=>s(e,"checkbox"))&&(e="all"),h.android.checkableBehavior=e}N=!0}else""===c.android("checkableBehavior")&&s(r,"checkbox")&&(h.android.checkable="true"),m=(l.title||l.innerText).trim();switch(u){case n.ITEM:if(d(o,l,h),""===r.android("icon")){let e=i.addImageURL(l.style.backgroundImage,t.DRAWABLE_PREFIX.MENU);if(""!==e)h.android.icon=`@drawable/${e}`;else{const n=r.children.find(e=>e.imageElement);n&&""!==(e=i.addImageSrcSet(n.element,t.DRAWABLE_PREFIX.MENU))&&(h.android.icon=`@drawable/${e}`)}}break;case n.GROUP:d(a,l,h)}if(""===r.android("title")&&""!==m){const e=i.addString(m,"",this.application.settings);""!==e&&(m=`@string/${e}`),h.android.title=m}h.android.id?r.controlName=u:r.setNodeType(u);const E=this.application.viewController.renderNodeStatic(u,c.renderDepth+1,h,"","",r,N);return r.excludeResource|=e.NODE_RESOURCE.ALL,r.excludeProcedure|=e.NODE_PROCEDURE.ALL,r.rendered=!0,{output:E,complete:!0,next:p}}afterRender(){super.afterRender(),this.included(this.node.element)&&(this.application.layoutProcessing.pathname="res/menu")}}("android.widget.menu",2,["NAV"]);return androme&&androme.registerExtension(c),c}();
