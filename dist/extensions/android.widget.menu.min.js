this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";var e=androme.lib.enumeration,t=androme.lib.dom,n=android.lib.base.Resource,i=android.lib.constant,o=android.lib.util;const a={MENU:"menu",ITEM:"item",GROUP:"group"},r={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^[0-9]+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},d={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/};function s(e,t){return e.some(e=>e.element.type===t)}function c(e,t,n){for(const i in t.dataset){const o=t.dataset[i];if(o&&e[i]){const t=o.match(e[i]);t&&(n.android[i]=Array.from(new Set(t)).join("|"))}}}const l=new class extends androme.lib.base.extensions.Nav{condition(){return this.included()}processNode(){const t=this.node,n=this.application.viewController.renderNodeStatic(a.MENU,0,{},"","",t,!0);return t.documentRoot=!0,t.nodeType=e.NODE_STANDARD.BLOCK,t.excludeResource|=e.NODE_RESOURCE.ALL,t.excludeProcedure|=e.NODE_PROCEDURE.ALL,t.rendered=!0,t.cascade().forEach(e=>this.subscribersChild.add(e)),{output:n,complete:!0}}processChild(){const l=this.node,u=this.parent;if(l.plainText)return l.hide(),{output:"",complete:!0,next:!0};const m=l.element,h=o.createViewAttribute();let b=a.ITEM,g="",N=!1,E=!1;if(l.some(e=>(!e.inlineElement||!e.blockStatic)&&e.length>0)){if(l.some(e=>"NAV"===e.tagName))""!==m.title?g=m.title:Array.from(l.element.childNodes).some(e=>"#text"===e.nodeName?!(!e.textContent||""===(g=e.textContent.trim())):"NAV"!==e.tagName&&(g=e.innerText.trim(),!0)),l.each(e=>"NAV"!==e.tagName&&e.hide());else if("NAV"===l.tagName)b=a.MENU,N=!0;else{b=a.GROUP;let e="";l.every(e=>s(e,"radio"))?e="single":l.every(e=>s(e,"checkbox"))&&(e="all"),h.android.checkableBehavior=e}E=!0}else""===u.android("checkableBehavior")&&s(l,"checkbox")&&(h.android.checkable="true"),g=(m.title||m.innerText).trim();switch(b){case a.ITEM:if(c(r,m,h),""===l.android("icon")){const e=t.getStyle(m);let o=n.addImageURL("none"!==e.backgroundImage?e.backgroundImage:e.background,i.DRAWABLE_PREFIX.MENU);if(""!==o)h.android.icon=`@drawable/${o}`;else{const e=l.find(e=>e.imageElement);e&&""!==(o=n.addImageSrcSet(e.element,i.DRAWABLE_PREFIX.MENU))&&(h.android.icon=`@drawable/${o}`)}}break;case a.GROUP:c(d,m,h)}if(""===l.android("title")&&""!==g){const e=n.addString(g,"",this.application.settings);""!==e&&(g=`@string/${e}`),h.android.title=g}h.android.id?l.controlName=b:l.setNodeType(b);const p=this.application.viewController.renderNodeStatic(b,u.renderDepth+1,h,"","",l,E);return l.excludeResource|=e.NODE_RESOURCE.ALL,l.excludeProcedure|=e.NODE_PROCEDURE.ALL,l.rendered=!0,{output:p,complete:!0,next:N}}afterRender(){const e=this.node;super.afterRender(),this.included(e.element)&&(this.application.layoutProcessing.pathname="res/menu")}}("android.widget.menu",2,["NAV"]);return androme&&androme.registerExtensionAsync(l),l}();
