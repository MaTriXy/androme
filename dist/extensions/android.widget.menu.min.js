this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";var e=androme.lib.enumeration,t=android.lib.constant,i=android.lib.base.Resource;const n={MENU:"menu",ITEM:"item",GROUP:"group"},a={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^[0-9]+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},o={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},r=["showAsAction","actionViewClass","actionProviderClass"];function d(e,t){return e.children.length>0&&e.children.some(e=>e.element.type===t)}const s=new class extends androme.lib.base.extensions.Nav{condition(){return this.included()}processNode(){const t=this.node,i=this.application.viewController.renderNodeStatic(n.MENU,0,{},"","",t,!0);return t.documentRoot=!0,t.nodeType=e.NODE_STANDARD.BLOCK,t.excludeResource|=e.NODE_RESOURCE.ALL,t.excludeProcedure|=e.NODE_PROCEDURE.ALL,t.rendered=!0,t.cascade().forEach(e=>this.subscribersChild.add(e)),{output:i,complete:!0}}processChild(){const r=this.node,s=this.parent;if(r.plainText)return r.hide(),{output:"",complete:!0,next:!0};const c=r.element,l={android:{},app:{}};let h=n.ITEM,u="",m=!1,p=!1;if(r.children.some(e=>(!e.inlineElement||!e.blockStatic)&&e.children.length>0)){if(r.children.some(e=>"NAV"===e.tagName))""!==c.title?u=c.title:Array.from(r.element.childNodes).some(e=>"#text"===e.nodeName?!(!e.textContent||""===(u=e.textContent.trim())):"NAV"!==e.tagName&&(u=e.innerText.trim(),!0)),r.each(e=>"NAV"!==e.tagName&&e.hide());else if("NAV"===r.tagName)h=n.MENU,m=!0;else{h=n.GROUP;let e="";r.children.every(e=>d(e,"radio"))?e="single":r.children.every(e=>d(e,"checkbox"))&&(e="all"),l.android.checkableBehavior=e}p=!0}else""===s.android("checkableBehavior")&&d(r,"checkbox")&&(l.android.checkable="true"),u=(c.title||c.innerText).trim();switch(h){case n.ITEM:if(this.parseDataSet(a,c,l),""===r.android("icon")){let e=i.addImageURL(c.style.backgroundImage,t.DRAWABLE_PREFIX.MENU);if(""!==e)l.android.icon=`@drawable/${e}`;else{const n=r.children.find(e=>e.imageElement);n&&""!==(e=i.addImageSrcSet(n.element,t.DRAWABLE_PREFIX.MENU))&&(l.android.icon=`@drawable/${e}`)}}break;case n.GROUP:this.parseDataSet(o,c,l)}if(""===r.android("title")&&""!==u){const e=i.addString(u,"",this.application.settings);""!==e&&(u=`@string/${e}`),l.android.title=u}l.android.id?r.controlName=h:r.setNodeType(h);const N=this.application.viewController.renderNodeStatic(h,s.renderDepth+1,l,"","",r,p);return r.excludeResource|=e.NODE_RESOURCE.ALL,r.excludeProcedure|=e.NODE_PROCEDURE.ALL,r.rendered=!0,{output:N,complete:!0,next:m}}afterRender(){super.afterRender(),this.included(this.node.element)&&(this.application.layoutProcessing.pathname="res/menu")}parseDataSet(e,t,i){for(const n in t.dataset){const a=t.dataset[n];if(a&&e[n]){const t=a.match(e[n]);t&&(i[null!=this.options.appCompat&&!0!==this.options.appCompat||!r.includes(n)?"android":"app"][n]=Array.from(new Set(t)).join("|"))}}}}("android.widget.menu",2,["NAV"]);return androme&&androme.registerExtensionAsync(s),s}();
