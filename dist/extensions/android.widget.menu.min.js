this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";var e=androme.lib.enumeration,t=android.lib.constant,i=android.lib.util,n=androme.lib.dom,a=android.lib.base.Resource;const o={MENU:"menu",ITEM:"item",GROUP:"group"},r={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^[0-9]+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},d={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/};function s(e,t){return e.some(e=>e.element.type===t)}const c=new class extends androme.lib.base.extensions.Nav{condition(){return this.included()}processNode(){const t=this.node,i=this.application.viewController.renderNodeStatic(o.MENU,0,{},"","",t,!0);return t.documentRoot=!0,t.nodeType=e.NODE_STANDARD.BLOCK,t.excludeResource|=e.NODE_RESOURCE.ALL,t.excludeProcedure|=e.NODE_PROCEDURE.ALL,t.rendered=!0,t.cascade().forEach(e=>this.subscribersChild.add(e)),{output:i,complete:!0}}processChild(){const c=this.node,l=this.parent;if(c.plainText)return c.hide(),{output:"",complete:!0,next:!0};const u=c.element,m=i.createViewAttribute();let h=o.ITEM,b="",g=!1,N=!1;if(c.some(e=>(!e.inlineElement||!e.blockStatic)&&e.length>0)){if(c.some(e=>"NAV"===e.tagName))""!==u.title?b=u.title:Array.from(c.element.childNodes).some(e=>"#text"===e.nodeName?!(!e.textContent||""===(b=e.textContent.trim())):"NAV"!==e.tagName&&(b=e.innerText.trim(),!0)),c.each(e=>"NAV"!==e.tagName&&e.hide());else if("NAV"===c.tagName)h=o.MENU,g=!0;else{h=o.GROUP;let e="";c.every(e=>s(e,"radio"))?e="single":c.every(e=>s(e,"checkbox"))&&(e="all"),m.android.checkableBehavior=e}N=!0}else""===l.android("checkableBehavior")&&s(c,"checkbox")&&(m.android.checkable="true"),b=(u.title||u.innerText).trim();switch(h){case o.ITEM:if(this.parseDataSet(r,u,m),""===c.android("icon")){const e=n.getStyle(u);let i=a.addImageURL("none"!==e.backgroundImage?e.backgroundImage:e.background,t.DRAWABLE_PREFIX.MENU);if(""!==i)m.android.icon=`@drawable/${i}`;else{const e=c.find(e=>e.imageElement);e&&""!==(i=a.addImageSrcSet(e.element,t.DRAWABLE_PREFIX.MENU))&&(m.android.icon=`@drawable/${i}`)}}break;case o.GROUP:this.parseDataSet(d,u,m)}if(""===c.android("title")&&""!==b){const e=a.addString(b,"",this.application.settings);""!==e&&(b=`@string/${e}`),m.android.title=b}m.android.id?c.controlName=h:c.setNodeType(h);const p=this.application.viewController.renderNodeStatic(h,l.renderDepth+1,m,"","",c,N);return c.excludeResource|=e.NODE_RESOURCE.ALL,c.excludeProcedure|=e.NODE_PROCEDURE.ALL,c.rendered=!0,{output:p,complete:!0,next:g}}afterRender(){const e=this.node;super.afterRender(),this.included(e.element)&&(this.application.layoutProcessing.pathname="res/menu")}parseDataSet(e,t,i){for(const n in t.dataset){const a=t.dataset[n];if(a&&e[n]){const t=a.match(e[n]);t&&(i.android[n]=Array.from(new Set(t)).join("|"))}}}}("android.widget.menu",2,["NAV"]);return androme&&androme.registerExtensionAsync(c),c}();
