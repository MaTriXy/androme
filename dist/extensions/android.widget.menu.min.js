this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.menu=function(){"use strict";var e=androme.lib.enumeration,t=android.lib.constant,i=android.lib.base.Resource;const n={MENU:"menu",ITEM:"item",GROUP:"group"},a={id:/^@\+id\/\w+$/,title:/^.+$/,titleCondensed:/^.+$/,icon:/^@drawable\/.+$/,onClick:/^.+$/,showAsAction:/^(ifRoom|never|withText|always|collapseActionView)$/,actionLayout:/^@layout\/.+$/,actionViewClass:/^.+$/,actionProviderClass:/^.+$/,alphabeticShortcut:/^[a-zA-Z]+$/,alphabeticModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,numericShortcut:/^[0-9]+$/,numericModifiers:/(META|CTRL|ALT|SHIFT|SYM|FUNCTION)+/g,checkable:/^(true|false)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},r={id:/^@\+id\/\w+$/,checkableBehavior:/^(none|all|single)$/,visible:/^(true|false)$/,enabled:/^(true|false)$/,menuCategory:/^(container|system|secondary|alternative)$/,orderInCategory:/^[0-9]+$/},o=["showAsAction","actionViewClass","actionProviderClass"];const d=new class extends androme.lib.base.extensions.Nav{condition(){return this.included()}processNode(){const t=this.node,i=this.application.viewController.renderNodeStatic(n.MENU,0,{},"","",t,!0);return t.documentRoot=!0,t.nodeType=e.NODE_STANDARD.BLOCK,t.excludeResource|=e.NODE_RESOURCE.ALL,t.excludeProcedure|=e.NODE_PROCEDURE.ALL,t.rendered=!0,t.cascade().forEach(e=>this.subscribersChild.add(e)),{output:i,complete:!0}}processChild(){const o=this.node,d=this.parent;if(o.plainText)return o.hide(),{output:"",complete:!0,next:!0};const s=o.element,c={android:{},app:{}};let l=n.ITEM,h="",u=!1,m=!1;if(o.children.some(e=>(!e.inlineElement||!e.blockStatic)&&e.children.length>0)){if(o.children.some(e=>"NAV"===e.tagName))""!==s.title?h=s.title:Array.from(o.element.childNodes).some(e=>"#text"===e.nodeName?!(!e.textContent||""===(h=e.textContent.trim())):"NAV"!==e.tagName&&(h=e.innerText.trim(),!0)),o.each(e=>"NAV"!==e.tagName&&e.hide());else if("NAV"===o.tagName)l=n.MENU,u=!0;else{l=n.GROUP;let e="";o.children.every(e=>this.hasInputType(e,"radio"))?e="single":o.children.every(e=>this.hasInputType(e,"checkbox"))&&(e="all"),c.android.checkableBehavior=e}m=!0}else""===d.android("checkableBehavior")&&this.hasInputType(o,"checkbox")&&(c.android.checkable="true"),h=(s.title||s.innerText).trim();switch(l){case n.ITEM:if(this.parseDataSet(a,s,c),""===o.android("icon")){let e=i.addImageURL(s.style.backgroundImage,t.DRAWABLE_PREFIX.MENU);if(""!==e)c.android.icon=`@drawable/${e}`;else{const n=o.children.find(e=>e.imageElement);n&&""!==(e=i.addImageSrcSet(n.element,t.DRAWABLE_PREFIX.MENU))&&(c.android.icon=`@drawable/${e}`)}}break;case n.GROUP:this.parseDataSet(r,s,c)}if(""===o.android("title")&&""!==h){const e=i.addString(h,"",this.application.settings);""!==e&&(h=`@string/${e}`),c.android.title=h}c.android.id?o.controlName=l:o.setNodeType(l);const p=this.application.viewController.renderNodeStatic(l,d.renderDepth+1,c,"","",o,m);return o.excludeResource|=e.NODE_RESOURCE.ALL,o.excludeProcedure|=e.NODE_PROCEDURE.ALL,o.rendered=!0,{output:p,complete:!0,next:u}}afterRender(){super.afterRender(),this.included(this.node.element)&&(this.application.layoutProcessing.pathname="res/menu")}parseDataSet(e,t,i){for(const n in t.dataset){const a=t.dataset[n];if(a&&e[n]){const t=a.match(e[n]);t&&(i[null!=this.options.appCompat&&!0!==this.options.appCompat||!o.includes(n)?"android":"app"][n]=Array.from(new Set(t)).join("|"))}}}hasInputType(e,t){return e.children.length>0&&e.children.some(e=>e.element.type===t)}}("android.widget.menu",2,["NAV"]);return androme&&androme.registerExtension(d),d}();
