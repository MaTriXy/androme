this.android=this.android||{},this.android.widget=this.android.widget||{},this.android.widget.toolbar=function(){"use strict";var e={__FRAMEWORK:2,FAB:"android.widget.floatingactionbutton",MENU:"android.widget.menu",COORDINATOR:"android.widget.coordinator",TOOLBAR:"android.widget.toolbar",DRAWER:"android.widget.drawer",BOTTOM_NAVIGATION:"android.widget.bottomnavigation"};var t='<?xml version="1.0" encoding="utf-8"?>\n<resources>\n\t<style name="{&appTheme}" parent="{~parentTheme}">\n!1\n\t\t<item name="{&name}">{&value}</item>\n!1\n\t</style>\n\t<style name="{&appTheme}.NoActionBar">\n\t\t<item name="windowActionBar">false</item>\n\t\t<item name="windowNoTitle">true</item>\n\t</style>\n\t<style name="AppTheme.AppBarOverlay" parent="{~appBarOverlay}" />\n\t<style name="AppTheme.PopupOverlay" parent="{~popupOverlay}" />\n</resources>',a=android.lib.base.View,r=androme.lib.enumeration,i=androme.lib.constant,o=android.lib.constant,n=androme.lib.util,s=android.lib.util,l=androme.lib.dom,d=androme.lib.xml,p=android.lib.base.Resource;const c=new class extends androme.lib.base.Extension{constructor(t,a,r,i){super(t,a,r,i),this.require(e.MENU)}init(t){if(this.included(t)&&(Array.from(t.children).some(e=>"NAV"===e.tagName&&!n.includes(e.dataset.ext,i.EXT_NAME.EXTERNAL)&&(e.dataset.ext=(n.hasValue(e.dataset.ext)?`${e.dataset.ext}, `:"")+i.EXT_NAME.EXTERNAL,!0)),t.dataset.target)){const a=document.getElementById(t.dataset.target);a&&t.parentElement!==a&&!n.includes(a.dataset.ext,e.COORDINATOR)&&this.application.viewElements.add(t)}return!1}processNode(){const t=this.application.viewController,a=this.node,i=this.parent,c=n.hasValue(a.dataset.target),u=Object.assign({},this.options[a.element.id]),h=s.createViewAttribute(u.self),m=s.createViewAttribute(u.appBar),g=s.createViewAttribute(u.collapsingToolbar),w=null!=l.getNestedExtension(a.element,e.MENU),O=a.has("backgroundImage"),f=[],A=[];let E,v=c?0:a.depth,T=a.filter(e=>e.auto).length;Array.from(a.element.children).forEach(e=>{if("IMG"===e.tagName){if(n.hasValue(e.dataset.navigationIcon)){const t=p.addImageSrcSet(e,o.DRAWABLE_PREFIX.MENU);""!==t&&(n.overwriteDefault(toolbar,"app","navigationIcon",`@drawable/${t}`),"none"!==l.getStyle(e).display&&T--)}if(n.hasValue(e.dataset.collapseIcon)){const t=p.addImageSrcSet(e,o.DRAWABLE_PREFIX.MENU);""!==t&&(n.overwriteDefault(toolbar,"app","collapseIcon",`@drawable/${t}`),"none"!==l.getStyle(e).display&&T--)}}if(n.hasValue(e.dataset.target))T--;else{const t=l.getNodeFromElement(e);if(t)switch(e.dataset.targetModule){case"appBar":f.push(t),T--;break;case"collapsingToolbar":A.push(t),T--}}});const y=u.hasOwnProperty("collapsingToolbar")||A.length>0,R=u.hasOwnProperty("appBar")||f.length>0||y;let b="",D="";y?n.overwriteDefault(h,"app","layout_collapseMode","pin"):(R||n.overwriteDefault(h,"android","fitsSystemWindows","true"),n.overwriteDefault(h,"app","popupTheme","@style/ThemeOverlay.AppCompat.Light"),O?(n.overwriteDefault(f.length>0?m:h,"android","background",`@drawable/${p.addImageURL(a.css("backgroundImage"))}`),a.excludeResource|=r.NODE_RESOURCE.IMAGE_SOURCE):n.overwriteDefault(h,"app","layout_scrollFlags","scroll|enterAlways")),f.length>0?n.overwriteDefault(m,"android","layout_height","?android:attr/actionBarSize"):(n.overwriteDefault(h,"android","layout_height","?android:attr/actionBarSize"),a.excludeProcedure|=r.NODE_PROCEDURE.LAYOUT),w&&R&&(h.app.popupTheme&&(D=h.app.popupTheme.replace("@style/","")),h.app.popupTheme="@style/AppTheme.PopupOverlay");const I=v+(R?1:0)+(y?1:0);if(E=t.renderNodeStatic(o.VIEW_SUPPORT.TOOLBAR,I,p.formatOptions(h,this.application.settings),"match_parent","wrap_content",a,T>0),y&&O){const e=s.createViewAttribute(u.backgroundImage);let i="center";switch(a.css("backgroundSize")){case"cover":case"100% auto":case"auto 100%":i="centerCrop";break;case"contain":case"100% 100%":i="fitXY";break;case"auto":i="matrix"}n.overwriteDefault(e,"android","id",`${a.stringId}_image`),n.overwriteDefault(e,"android","src",`@drawable/${p.addImageURL(a.css("backgroundImage"))}`),n.overwriteDefault(e,"android","scaleType",i),n.overwriteDefault(e,"android","fitsSystemWindows","true"),n.overwriteDefault(e,"app","layout_collapseMode","parallax"),E=t.renderNodeStatic(o.NODE_ANDROID.IMAGE,I,p.formatOptions(e,this.application.settings),"match_parent","match_parent")+E,a.excludeResource|=r.NODE_RESOURCE.IMAGE_SOURCE}let _,N,S="";if(R&&(n.overwriteDefault(m,"android","id",`${a.stringId}_appbar`),n.overwriteDefault(m,"android","layout_height",a.viewHeight>0?s.delimitUnit("appbar","height",n.formatPX(a.viewHeight),this.application.settings):"wrap_content"),n.overwriteDefault(m,"android","fitsSystemWindows","true"),w?(m.android.theme&&(b=m.android.theme),m.android.theme="@style/AppTheme.AppBarOverlay",this.setResourceTheme(b,D)):n.overwriteDefault(m,"android","theme","@style/ThemeOverlay.AppCompat.Dark.ActionBar"),(_=this.createPlaceholder(this.application.cacheProcessing.nextId,a,f)).parent=a.parent,_.nodeId=s.stripId(m.android.id),this.application.cacheProcessing.append(_,f.length>0),S=t.renderNodeStatic(o.VIEW_SUPPORT.APPBAR,c?-1:v,p.formatOptions(m,this.application.settings),"match_parent","wrap_content",_,!0),y&&(v++,n.overwriteDefault(g,"android","id",`${a.stringId}_collapsingtoolbar`),n.overwriteDefault(g,"android","fitsSystemWindows","true"),O||n.overwriteDefault(g,"app","contentScrim","?attr/colorPrimary"),n.overwriteDefault(g,"app","layout_scrollFlags","scroll|exitUntilCollapsed"),n.overwriteDefault(g,"app","toolbarId",a.stringId),(N=this.createPlaceholder(this.application.cacheProcessing.nextId,a,A)).parent=_,N))){N.each(e=>e.dataset.target=N.nodeId),this.application.cacheProcessing.append(N,A.length>0);const e=t.renderNodeStatic(o.VIEW_SUPPORT.COLLAPSING_TOOLBAR,c&&!R?-1:v,p.formatOptions(g,this.application.settings),"match_parent","match_parent",N,!0);S=d.replacePlaceholder(S,_.id,e)}return _?(E=d.replacePlaceholder(S,N?N.id:_.id,E),_.render(c?_:i),N?(N.parent=_,N.render(_),a.parent=N):a.parent=_,a.data(e.TOOLBAR,"outerParent",_.stringId),a.render(a.parent)):N?(N.render(c?N:i),a.parent=N,a.render(N)):a.render(c?a:i),a.nodeType=r.NODE_STANDARD.BLOCK,a.excludeResource|=r.NODE_RESOURCE.FONT_STYLE,{output:E,complete:!1}}processChild(){const e=this.node;return e.imageElement&&(n.hasValue(e.dataset.navigationIcon)||n.hasValue(e.dataset.collapseIcon))?(e.hide(),{output:"",complete:!0,next:!0}):{output:"",complete:!1}}beforeInsert(){const t=this.node,a=n.optional(l.getNestedExtension(t.element,e.MENU),"dataset.layoutName");if(""!==a){const e=Object.assign({},this.options[t.element.id]),r=s.createViewAttribute(e.self);n.overwriteDefault(r,"app","menu",`@menu/${a}`),t.app("menu",r.app.menu)}}setResourceTheme(a,r){const i=Object.assign({},this.options.resource);n.overwriteDefault(i,"","appTheme","AppTheme"),n.overwriteDefault(i,"","parentTheme","Theme.AppCompat.Light.DarkActionBar");const o={appTheme:i.appTheme,parentTheme:i.parentTheme,appBarOverlay:a||"ThemeOverlay.AppCompat.Dark.ActionBar",popupOverlay:r||"ThemeOverlay.AppCompat.Light",1:[]};n.overwriteDefault(i,"output","path","res/values"),n.overwriteDefault(i,"output","file",`${e.TOOLBAR}.xml`),this.application.resourceHandler.addStyleTheme(t,o,i)}createPlaceholder(e,t,i){const o=new a(e,void 0,this.application.viewController.delegateNodeInit);return o.init(),i.forEach(e=>e.parent=o),o.inherit(t,"dimensions"),o.auto=!1,o.excludeResource|=r.NODE_RESOURCE.ALL,o}}(e.TOOLBAR,e.__FRAMEWORK);return androme&&androme.registerExtensionAsync(c),c}();
